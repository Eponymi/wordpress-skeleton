role :server,               "{{deploy.develop.web.host}}"

set :copy_strategy,         :export
set :copy_exclude,          [".git"]

set :deploy_to,             "/var/www/#{application}"
set :deploy_via,            :copy

set :repository,            File.expand_path(File.dirname(__FILE__) + "/../../")

set :scm,                   :none
set :use_sudo,              true

set :user,                  "{{deploy.develop.web.user}}"
set :password,              "{{deploy.develop.web.password}}"

set :group_writable,        true

default_run_options[:pty] = true

after "deploy:update", "wordpress:theme:symlink"

namespace :deploy do
    task :update_code do
        logger.important "`deploy:update_code` skipped because folder is mounted"
        run "#{try_sudo} ln -s /vagrant #{release_path}"
        finalize_update
    end
end
